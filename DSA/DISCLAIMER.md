All of this is EXTREMELY not pythonic. Done deliberately to abstract and generalise.